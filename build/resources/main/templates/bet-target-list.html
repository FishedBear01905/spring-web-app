<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Bet Target 一覧</title>
    <script>
        function showForm(targetId) {
            // すべてのフォームを非表示にする
            document.querySelectorAll('.bet-form').forEach(form => form.style.display = 'none');
            // 選択したターゲットのフォームを表示
            document.getElementById('form-' + targetId).style.display = 'block';
        }
    </script>
</head>
<body>
    <div th:insert="~{fragments/header :: header}"></div>

    <h1>Room ID: <span th:text="${roomId}"></span> の Bet Target 一覧</h1>
    <table border="1">
        <thead>
            <tr>
                <th>ID</th>
                <th>名前</th>
                <th>説明</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="betTarget : ${betTargets}">
                <td th:text="${betTarget.id}"></td>
                <td th:text="${betTarget.targetTitle}"></td>
                <td th:text="${betTarget.targetDescription}"></td>
                <td>
                    <button type="button" th:onclick="'showForm(' + ${betTarget.id} + ')'">選択</button>
                </td>
            </tr>
        </tbody>
    </table>

    <!-- 入力フォーム -->
    <div th:each="betTarget : ${betTargets}" th:id="'form-' + ${betTarget.id}" class="bet-form" style="display: none;">
        <h2 th:text="'Bet Target: ' + ${betTarget.targetTitle}"></h2>
        <form th:action="@{/bet/save}" method="post">
            <input type="hidden" th:name="betTargetId" th:value="${betTarget.id}" />
            <input type="hidden" th:name="betRoomId" th:value="${betTarget.gambleRoomId}" />
            <input type="hidden" th:name="userId" th:value="${session.loggedInUser.id}" />
            <label for="betPrice">賭け金額:</label>
            <input type="number" name="betPrice" id="betPrice" required />
            <button type="submit">適用</button>
        </form>
    </div>

    <a href="/room/list">部屋一覧に戻る</a>
</body>
</html>